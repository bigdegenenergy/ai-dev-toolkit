# ⚠️ REVIEW INSTRUCTIONS

> **DELETE THIS FILE** after reading and addressing the issues.
> This file was generated by the Review Agent (Gemini).

## Workflow

1. Read the issues below
2. Fix the code
3. **DELETE this file** (`git rm REVIEW_INSTRUCTIONS.md`)
4. Commit with `Agent-Note:` trailer explaining your fixes

## Example Commit

```
fix: address review feedback

Agent-Note: Fixed SQL injection in auth.ts by using parameterized queries.
```

---

## Issues to Address

```toml
[review]
summary = "The PR introduces a promising agentic workflow but accidentally commits ephemeral artifacts and includes CI configurations that will break on forked repositories. Security scoping for the agent command needs tightening."
decision = "REQUEST_CHANGES"

[[issues]]
severity = "important"
file = "REVIEW_INSTRUCTIONS.md"
title = "Ephemeral artifact committed to repository"
description = "The `REVIEW_INSTRUCTIONS.md` file is intended to be a temporary communication channel between agents and should be deleted by the coding agent before committing. Its presence in the PR indicates the `/wake` cycle did not complete successfully or the file was manually added."
suggestion = "Remove this file from the PR and ensure `.gitignore` prevents it from being committed in the future."

[[issues]]
severity = "critical"
file = ".github/workflows/gemini-pr-review-plus.yml"
title = "Workflow fails on forked repositories"
description = "The workflow uses `contents: write` and attempts to `git push` changes back to the branch. This will fail for Pull Requests originating from forks because the `GITHUB_TOKEN` is read-only for forks. This effectively breaks CI for external contributors."
suggestion = "Add a condition to skip the push step if `github.event.pull_request.head.repo.fork` is true, or use `continue-on-error: true` for the push step."

[[issues]]
severity = "important"
file = ".claude/commands/wake.md"
title = "Excessive agent permissions"
description = "The `/wake` command grants `Bash(*)` permissions to the agent. In a security-sensitive repo handling transactions/keys, giving the agent unrestricted shell access is high risk. If the instruction file is spoofed, it could lead to arbitrary code execution."
suggestion = "Restrict `allowed-tools` to the specific git commands and file operations needed (e.g., `Bash(git, rm, ls)`), or ensure strict sandboxing of the agent environment."

[[issues]]
severity = "suggestion"
file = ".github/workflows/gemini-pr-review-plus.yml"
line = 158
title = "Potential infinite loop on push"
description = "While `GITHUB_TOKEN` pushes typically don't trigger workflows, using `[skip ci]` in the commit message is a safer practice to guarantee this workflow doesn't trigger itself recursively if the token type changes in the future."
suggestion = "Ensure the commit message in the workflow (line 158) retains the `[skip ci]` tag (it currently does, but verify it works with the specific CI provider settings)."
```
