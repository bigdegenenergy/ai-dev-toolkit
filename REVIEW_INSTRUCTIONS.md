# ⚠️ REVIEW INSTRUCTIONS

> **DELETE THIS FILE** after reading and addressing the issues.
> This file was generated by the Review Agent (Gemini).

## Workflow

1. Read the issues below
2. Fix the code
3. **DELETE this file** (`git rm REVIEW_INSTRUCTIONS.md`)
4. Commit with `Agent-Note:` trailer explaining your fixes

## Example Commit

```
fix: address review feedback

Agent-Note: Fixed SQL injection in auth.ts by using parameterized queries.
```

---

## Issues to Address

```toml
[review]
summary = "The workflow refactoring introduces a critical branch-targeting bug when triggered by issue comments, and references incorrect context variables for notifications."
decision = "REQUEST_CHANGES"

[[issues]]
severity = "critical"
file = ".github/workflows/gemini-pr-review-plus.yml"
line = 33
title = "Incorrect checkout and push target for issue_comment events"
description = "When triggered by `issue_comment`, `github.head_ref` is empty and `github.ref` points to the default branch (e.g., `main`), not the PR branch. This causes `actions/checkout` to pull `main`, and the subsequent `git push` (line 169) to attempt pushing the `REVIEW_INSTRUCTIONS.md` file directly to `main`. This could corrupt the default branch."
suggestion = "Remove the `issue_comment` trigger, or add a step to resolve the correct PR branch ref via the GitHub CLI (`gh pr view ...`) before the checkout step."

[[issues]]
severity = "important"
file = ".github/workflows/gemini-pr-review-plus.yml"
line = 181
title = "Missing commit message in notifications"
description = "The variable `github.event.head_commit.message` is not available in `pull_request` event payloads (it is null). The Telegram notification will send with an empty or broken message field."
suggestion = "Use `${{ github.event.pull_request.title }}` for PR events, or extract the latest commit message using `git log -1 --format=%s` in a previous step."

[[issues]]
severity = "suggestion"
file = ".claude/commands/wake.md"
line = 13
title = "Verify Model ID"
description = "The model ID `claude-opus-4-5-20251101` appears to be a specific future-dated or internal version. Ensure this is valid in your environment to prevent execution errors."
```
