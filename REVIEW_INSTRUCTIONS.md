# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```json
{
  "review": {
    "summary": "The PR introduces a complex two-tier model selection logic and web research capabilities. However, the critical workflow file `.github/workflows/claude.yml` is unreviewable due to a parsing error. Given the security sensitivity of handling PR comments in workflows (script injection risks) and the addition of arbitrary web fetching, I cannot approve this without seeing the implementation details.",
    "decision": "REQUEST_CHANGES"
  },
  "issues": [
    {
      "id": 1,
      "severity": "critical",
      "file": ".github/workflows/claude.yml",
      "line": 0,
      "title": "Workflow file diff unavailable",
      "description": "The diff for `.github/workflows/claude.yml` failed to parse. I cannot verify the security or correctness of the new two-tier model selection logic or comment handling.",
      "suggestion": "Fix the diff availability so the workflow logic can be reviewed."
    },
    {
      "id": 2,
      "severity": "important",
      "file": ".github/workflows/claude.yml",
      "line": 0,
      "title": "Potential Script Injection Risk in Comment Handling",
      "description": "The PR description mentions extracting comment bodies to route requests. If the workflow interpolates `github.event.comment.body` directly into a shell script (e.g., `run: ... ${{ github.event.comment.body }}`), it is vulnerable to Script Injection. The commit message mentions adding env var mapping for `curl`, but this must be verified for the extraction step as well.",
      "suggestion": "Ensure that ALL user inputs (comments, titles) are passed to shell scripts exclusively via environment variables (e.g., `env: BODY: ${{ github.event.comment.body }}`) and referenced as shell variables (`$BODY`), never injected directly."
    },
    {
      "id": 3,
      "severity": "important",
      "file": ".github/mcp-config.json.template",
      "line": 1,
      "title": "SSRF Risk via 'fetch' MCP server",
      "description": "Enabling `@anthropics/mcp-server-fetch` allows the agent to perform arbitrary HTTP GET requests. In a CI/CD environment or a developer's local machine, this could allow the agent to access internal metadata services (e.g., cloud instance metadata) or local network services (SSRF) if prompted maliciously.",
      "suggestion": "Consider if the `fetch` tool should be unrestricted. If used in a CI environment, ensure the runner is network-isolated or user is warned about SSRF risks."
    },
    {
      "id": 4,
      "severity": "suggestion",
      "file": "PR Description",
      "line": 1,
      "title": "Incomplete PR Description",
      "description": "The 'Changes Made' section of the PR description is empty, despite significant feature additions.",
      "suggestion": "Update the PR description to list the key changes (Two-tier routing, Web research capability) to aid future maintainers."
    }
  ]
}
```