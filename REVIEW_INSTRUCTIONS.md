# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```toml
[review]
summary = "The PR introduces a robust 'Human-in-the-loop' AI coding workflow. The security architecture is mature, specifically the 'trusted scripts' pattern which effectively mitigates Remote Code Execution (RCE) risks from malicious PRs, and the strict `author_association` checks which prevent unauthorized agent usage. The switch to `.cjs` and pinned dependencies further hardens the implementation. However, the workflow will likely fail when attempting to push changes to PRs originating from forks due to standard GitHub Token permission limitations."
decision = "APPROVE"

[[issues]]
severity = "important"
file = ".github/workflows/claude-code-implement.yml"
line = 0
title = "GitHub Token cannot push to fork repositories"
description = "The workflow uses `secrets.GITHUB_TOKEN` (via the default runner context) to commit and push changes generated by Claude. While the PR lookup logic correctly identifies forks (`head_repository.owner.login`), the standard `GITHUB_TOKEN` in an `issue_comment` workflow context does *not* have write permissions to push code back to a forked repository. Consequently, the `/implement` command will fail with a 'permission denied' error on PRs from external contributors."
suggestion = "If support for external contributor PRs is required, you must use a GitHub App token or a Personal Access Token (PAT) with `repo` scope stored as a secret. If this feature is intended solely for internal team usage, this limitation should be explicitly documented in `CLAUDE.md`."

[[issues]]
severity = "suggestion"
file = ".github/scripts/claude-code-implement.cjs"
line = 0
title = "Verify Tool Restrictions"
description = "The Agent Notes mention that the Bash tool was removed and the agent is restricted to file operations. This is a critical security control. Please verify that the `Client` initialization in the script explicitly defines a `tools` array that excludes `Bash` or shell execution capabilities. Relying solely on the system prompt for tool restriction is insufficient; it must be enforced at the SDK configuration level."
suggestion = "Ensure `tools` is configured to whitelist only necessary capabilities (e.g., `FileEditor`) to minimize the blast radius of any potential prompt injection."

[[issues]]
severity = "suggestion"
file = ".github/workflows/pr-review-prompt.yml"
line = 0
title = "Dependence on artifact existence"
description = "The workflow logic depends on the existence of `REVIEW_INSTRUCTIONS.md` to decide whether to prompt the user. Ensure the upstream Gemini review workflow reliably generates this file only when actionable feedback exists, and cleans it up appropriately to prevent 'ghost' prompts on clean PRs."
suggestion = "Verify the artifact upload/download logic ensures synchronization between the review state and the prompt workflow."
```