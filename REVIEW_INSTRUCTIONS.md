# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```json
{
  "review": {
    "summary": "The proposed 'router' pattern is a good strategy for cost optimization, but the implementation relies on non-existent/future-dated model identifiers (e.g., `claude-haiku-4-5-20251001`). These will cause API calls to fail (400 Bad Request). Additionally, the manual `curl` step for classification requires explicit environment variable mapping for the API key, which is often missed in shell steps.",
    "decision": "REQUEST_CHANGES"
  },
  "issues": [
    {
      "id": 1,
      "severity": "critical",
      "file": ".github/workflows/claude.yml",
      "line": 0,
      "title": "Invalid Model Identifiers",
      "description": "The workflow uses model IDs `claude-haiku-4-5-20251001` and `claude-opus-4-5-20251101`. These versions do not exist in the Anthropic API. Using them will result in immediate workflow failure.",
      "suggestion": "Replace with valid model IDs such as `claude-3-haiku-20240307` and `claude-3-opus-20240229` (or the `3-5` variants if available)."
    },
    {
      "id": 2,
      "severity": "important",
      "file": ".github/workflows/claude.yml",
      "line": 0,
      "title": "Missing Environment Variable Mapping",
      "description": "The new shell step uses `$ANTHROPIC_API_KEY`, but GitHub Actions does not automatically expose secrets to shell environments. The `curl` command will fail with an authentication error.",
      "suggestion": "Add `env: ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}` to the step executing the curl command."
    },
    {
      "id": 3,
      "severity": "suggestion",
      "file": ".github/workflows/claude.yml",
      "line": 0,
      "title": "Robustness of JSON Parsing",
      "description": "The `sed` logic to strip markdown code fences is fragile. If the LLM outputs introductory text or slightly different formatting, the `jq` parse will fail, forcing the fallback logic.",
      "suggestion": "Update the system prompt to forbid markdown or preamble (return raw JSON only), or use a more robust extraction method (e.g., regex matching the JSON object)."
    }
  ]
}
```